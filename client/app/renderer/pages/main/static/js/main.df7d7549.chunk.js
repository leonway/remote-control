(this.webpackJsonpmain=this.webpackJsonpmain||[]).push([[0],{1:function(e,n){e.exports=require("electron")},13:function(e,n,t){},15:function(e,n,t){},17:function(e,n,t){"use strict";t.r(n);var r=t(3),a=t.n(r),c=t(7),o=t.n(c),i=(t(13),t(2)),s=t.n(i),u=t(4),d=t(5),p=(t.p,t(15),t(1)),l=t(8),f=new(t.n(l).a);window.peer=f,p.ipcRenderer.on("offer",(function(e,n){console.log("init pc",n);var t=new window.RTCPeerConnection;function r(){return a.apply(this,arguments)}function a(){return(a=Object(u.a)(s.a.mark((function e(){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.desktopCapturer.getSources({types:["screen"]});case 2:return n=e.sent,e.abrupt("return",new Promise((function(e,t){navigator.webkitGetUserMedia({audio:!1,video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:n[0].id,maxWidth:window.screen.width,maxHeight:window.screen.height}}},(function(n){console.log("add-stream",n),e(n)}),t)})));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function c(){return(c=Object(u.a)(s.a.mark((function e(n){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n="string"===typeof n?JSON.parse(n):n){e.next=3;break}return e.abrupt("return");case 3:return console.log("addIceCandidate---candidate",n,typeof n),e.next=6,t.addIceCandidate(new RTCIceCandidate(n));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function o(){return(o=Object(u.a)(s.a.mark((function e(n){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r();case 2:return a=e.sent,t.addStream(a),e.next=6,t.setRemoteDescription(n);case 6:return e.t0=t,e.next=9,t.createAnswer();case 9:return e.t1=e.sent,e.next=12,e.t0.setLocalDescription.call(e.t0,e.t1);case 12:return console.log("create answer \n",JSON.stringify(t.localDescription)),e.abrupt("return",t.localDescription);case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}t.ondatachannel=function(e){console.log("data",e),e.channel.onmessage=function(e){console.log("onmessage",e,JSON.parse(e.data));var n=JSON.parse(e.data),t=n.type,r=n.data;console.log("robot",t,r),"mouse"===t&&(r.screen={width:window.screen.width,height:window.screen.height}),p.ipcRenderer.send("robot",t,r)}},t.onicecandidate=function(e){e.candidate&&p.ipcRenderer.send("forward","puppet-candidate",JSON.stringify(e.candidate))},window.addIceCandidate=function(e){return c.apply(this,arguments)},function(e){return o.apply(this,arguments)}(n).then((function(e){p.ipcRenderer.send("forward","answer",{type:e.type,sdp:e.sdp})}))}));var h=t(0),w=p.remote.Menu,b=p.remote.MenuItem;var g=function(){var e=Object(r.useState)(""),n=Object(d.a)(e,2),t=n[0],a=n[1],c=Object(r.useState)(""),o=Object(d.a)(c,2),i=o[0],l=o[1],f=Object(r.useState)(""),g=Object(d.a)(f,2),j=g[0],v=g[1],x=function(){var e=Object(u.a)(s.a.mark((function e(){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.ipcRenderer.invoke("login");case 2:n=e.sent,l(n);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(r.useEffect)((function(){return x(),p.ipcRenderer.on("control-state-change",m),function(){p.ipcRenderer.removeListener("control-state-change",m)}}),[]);var m=function(e,n,t){console.log("handleControlState");var r="";1===t?r="\u6b63\u5728\u8fdc\u7a0b\u63a7\u5236".concat(n):2===t&&(r="\u88ab".concat(n,"\u63a7\u5236\u4e2d")),v(r)};return Object(h.jsx)("div",{className:"App",children:""===j?Object(h.jsxs)(h.Fragment,{children:[Object(h.jsxs)("div",{children:["\u4f60\u7684\u63a7\u5236\u7801",Object(h.jsx)("span",{onContextMenu:function(e){return function(e){e.preventDefault();var n=new w;n.append(new b({label:"\u590d\u5236",role:"copy"})),n.popup()}(e)},children:i})]}),Object(h.jsx)("input",{type:"text",value:t,onChange:function(e){return a(e.target.value)}}),Object(h.jsx)("br",{}),Object(h.jsx)("button",{onClick:function(){return e=t,void p.ipcRenderer.send("control",e);var e},children:"\u786e\u8ba4"})]}):Object(h.jsx)("div",{children:j})})},j=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,18)).then((function(n){var t=n.getCLS,r=n.getFID,a=n.getFCP,c=n.getLCP,o=n.getTTFB;t(e),r(e),a(e),c(e),o(e)}))};o.a.render(Object(h.jsx)(a.a.StrictMode,{children:Object(h.jsx)(g,{})}),document.getElementById("root")),j()},8:function(e,n){e.exports=require("events")}},[[17,1,2]]]);
//# sourceMappingURL=main.df7d7549.chunk.js.map